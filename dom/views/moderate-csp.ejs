<!DOCTYPE html>
<html lang="en">
<head>
  <%- include('partials/head') %>
  <!-- Moderate CSP Header -->
  <meta http-equiv="Content-Security-Policy" content="default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self'; object-src 'none'; base-uri 'self'">
</head>
<body>
  <%- include('partials/header') %>

  <main>
    <section>
      <h2>DOM XSS with Moderate CSP</h2>
      <p>This page implements a <strong>Moderate Content Security Policy</strong> against DOM XSS attacks.</p>
      
      <div class="csp-info">
        <h3>Current CSP Configuration:</h3>
        <code>Content-Security-Policy: default-src 'self'; script-src 'self'; style-src 'self'; img-src 'self'; object-src 'none'; base-uri 'self'</code>
        <p>This policy provides better protection but DOM XSS may still occur through unsafe DOM operations.</p>
      </div>
    </section>

    <%- include('partials/dom-xss-form') %>
  </main>

  <%- include('partials/footer') %>
  <script src="/js/dom-xss.js"></script>
</body>
</html>